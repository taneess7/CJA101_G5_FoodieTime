<!DOCTYPE html>
<html lang="zh-TW" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>餐廳-FoodieTime 食刻</title>
<meta name="description"
	content="探索各種泰式料理，尋找您喜愛的泰國風味美食。FoodieTime 食刻提供多樣化的泰式餐廳選擇，滿足您的味蕾需求。">
<link rel="stylesheet" th:href="@{/css/front/favoritelist/style.css}">
<link rel="stylesheet"
	th:href="@{/css/front/restaurant/restaurant-categories.css}">
<link rel="stylesheet"
	th:href="@{/css/front/restaurant/food-categories.css}">
<link rel="stylesheet"
	th:href="@{/css/front/restaurant/thai-cuisine.css}">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined">
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
	rel="stylesheet">

<meta name="theme-color" content="#FF5722">
<link rel="apple-touch-icon" th:href="@{/images/icons/logo.png}">

<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

</head>
<style>
.restaurant-contact-info {
	display: flex;
	flex-wrap: wrap; /* 換行時自動往下排 */
	gap: 12px 20px; /* 上下左右間距（行距、欄距） */
	align-items: center;
	font-size: 16px;
}

.restaurant-contact-info .info-item {
	display: flex;
	align-items: center;
	gap: 6px; /* icon 與文字的間距 */
	min-width: 180px; /* 控制每一欄寬度，防止黏在一起 */
	color: #444;
}

.restaurant-image {
	width: 70%;
	height: 200px;
	object-fit: cover;
	border-radius: 8px;
	margin-right: 20px;
}

.menu-card {
	display: flex;
	flex-wrap: wrap; /* ✅ 換行 */
	justify-content: left; /* ✅ 水平置中（你可改 space-between） */
	gap: 20px; /* ✅ 卡片間距 */
}

.menu-item {
	
}

.menu-item img {
	width: 120px; /* ✅ 你可以調整這邊大小 */
	height: 120px;
	object-fit: cover; /* ✅ 裁切填滿但不變形 */
	border-radius: 8px;
	display: block;
}

.modal-product-image {
	width: 265px; /* ✅ 固定寬度 */
	height: 275px; /* ✅ 固定高度：正方形 */
	object-fit: cover; /* ✅ 裁切但不變形 */
	border-radius: 8px;
	display: block;
	margin: 0 auto; /* ✅ 水平置中 */
}

.menu-item-info {
	text-align: center;
	width: 100%;
}

.menu-item-name {
	font-size: 18px;
	font-weight: bold;
}

.menu-item-description {
	font-size: 14px;
	color: #777;
	margin: 5px 0;
}

.menu-item-price {
	font-size: 16px;
	color: #c0392b;
	margin: 10px 0;
}

.add-to-cart-btn {
	background-color: #c0392b;
	color: white;
	border: none;
	border-radius: 50%;
	width: 36px;
	height: 36px;
	font-size: 16px;
	cursor: pointer;
	margin-top: 10px;
}

.favorite-btn i.fas.fa-heart {
	color: red;
}

.rating-stars i {
	color: #FFD700; /* 金黃色星星 */
	font-size: 1.2em;
	margin-right: 2px;
}
</style>
<body>
	<header th:replace="~{front/common/header :: main-header}"></header>

	<main>
		<section class="page-header">
			<div class="container">
				<h1 class="page-title"
					th:text="${categoryName != null ? categoryName : '搜尋結果'}">分類名稱</h1>
				<p class="page-description"
					th:text="'探索道地的 ' + (${categoryName != null ? categoryName : '美食'}) + '，從傳統小吃到精緻料理'">
					分類描述</p>
			</div>
		</section>

		<!-- 🔍 只有在關鍵字搜尋時才顯示「所有相關料理」 -->
		<section class="search-products"
			th:if="${param.keyword != null and not #lists.isEmpty(productList)}">
			<h2>相關料理</h2>
			<div class="menu-items">
				<div class="menu-item" th:each="prod : ${productList}">
					<img th:src="@{/product/image/{prodId}(prodId=${prod.prodId})}"
						th:alt="${prod.prodName}" class="menu-item-image"
						onerror="this.onerror=null; this.src='/images/restaurant/placeholder.svg';">
					<div class="menu-item-info">
						<h3 class="menu-item-name" th:text="${prod.prodName}">商品名稱</h3>
						<p class="menu-item-description" th:text="${prod.prodDesc}">商品描述</p>
						<span class="menu-item-price" th:text="'NT$ ' + ${prod.prodPrice}">價格</span>
					</div>
				</div>
			</div>
		</section>

		<!-- ❗查無結果顯示 -->
		<div class="container">
			<div
				th:if="${#lists.isEmpty(storeList) and #lists.isEmpty(productList)}"
				style="text-align: center; padding: 2em;">
				<h3>
					沒有符合「<span th:text="${param.keyword}">關鍵字</span>」的結果
				</h3>
				<p>請嘗試其他關鍵字。</p>
			</div>
		</div>
		<div class="container">
			<div class="restaurant-list">
				<article class="restaurant-detail" th:each="store : ${storeList}">
					<!-- 餐廳主區塊 -->
					<div class="restaurant-header">
						<div class="restaurant-main-info">
							<img
								th:src="'data:image/jpeg;base64,' + ${storeImageMap[store.storId]}"
								th:alt="${store.storName}" class="restaurant-image">
							<div class="restaurant-primary-info">
								<h2 class="restaurant-name" th:text="${store.storName}">餐廳名稱</h2>
								<span class="cuisine-tag cuisine-thai"
									th:text="${store.storeCate.storCatName}">泰式料理</span>
								<p class="restaurant-category" th:text=${store.storDesc}>湯品
									• 炒飯 • 沙拉</p>

								<!-- 評價星星開始 -->
								<!-- 評價星星開始 -->
								<div class="restaurant-rating"
									th:with="starNum=${store.starNum} ?: 0, reviews=${store.reviews} ?: 0">

									<!-- 星星圖示 -->
									<span class="rating-stars" th:if="${reviews > 0}"> <i
										th:each="i : ${#numbers.sequence(1, 5)}"
										th:classappend="${i <= starNum} ? 'fas fa-star' : 'far fa-star'"></i>
									</span>

									<!-- 評價數 -->
									<span th:if="${reviews > 0}"
										th:text="|${starNum} 顆星（${reviews} 則評價）|"></span> <span
										th:if="${reviews == 0}">尚無評價</span>
								</div>

								<!-- 評價星星結束 -->
								<!-- 主頁按鈕列 -->
								<div class="restaurant-actions"></div>
							</div>
						</div>
						<div class="restaurant-contact-info">
							<div class="info-item">
								<i class="fas fa-map-marker-alt"></i><span
									th:text="${store.storAddr}">地址</span>
							</div>
							<div class="info-item">
								<i class="fas fa-phone"></i><span th:text="${store.storPhone}">電話</span>
							</div>
							<div class="info-item">
								<i class="fas fa-clock"></i> <span
									th:if="${store.storOffDay != null and weekMap != null}"
									th:text="'營業時間: ' + ${store.storOnTime} + ' - ' + ${store.storOffTime} + '（' + ${weekMap[store.storOffDay]} + '公休）'">
								</span> <span th:unless="${store.storOffDay != null}"
									th:text="'營業時間: ' + ${store.storOnTime} + ' - ' + ${store.storOffTime} + '（公休日不固定）'">
								</span>
							</div>
							<div class="info-item">
								<i class="fa-solid fa-motorcycle"></i> <span
									th:text="${store.storDeliver} == 0 ? '無外送服務' : '可外送'"></span>
							</div>
							<div class="info-item"
								th:if="${store.storWeb != null and !store.storWeb.isEmpty()}">
								<i class="fas fa-globe"></i> <a
									th:href="${store.storWeb.startsWith('http') ? store.storWeb : 'http://' + store.storWeb}"
									th:text="${store.storWeb}" class="website-link">網站連結</a>
							</div>
						</div>

						<div class="restaurant-details-tabs">
							<div class="tabs-header">
								<button class="tab-btn" data-tab="menu"
									th:data-storeid="${store.storId}">菜單</button>
								<button class="tab-btn" data-tab="info"
									th:data-storeid="${store.storId}">店家資訊</button>
								<button class="tab-btn" data-tab="coupon"
									th:data-storeid="${store.storId}">優惠券</button>
							</div>
							<div class="tabs-content">
								<div class="tab-content active"
									th:id="'menu-content-' + ${store.storId}">
									<div class="menu-items">
										<div class="menu-item product-clickable"
											th:each="prod : ${storeProductMap[store.storId]}"
											th:attr="data-prod-id=${prod.prodId},
                                         data-prod-name=${prod.prodName},
                                         data-prod-desc=${prod.prodDesc},
                                         data-prod-price=${prod.prodPrice} ">
											<!--,-->
											<!--                                         data-prod-photo-url=@{/product/image/{prodId}(prodId=${prod.prodId})}">-->
											<img
												th:src="@{/product/image/{prodId}(prodId=${prod.prodId})}"
												th:alt="${prod.prodName}" class="menu-item-image"
												onerror="this.onerror=null; this.src='/images/restaurant/placeholder.svg';">
											<div class="menu-item-info">
												<h3 class="menu-item-name" th:text="${prod.prodName}">商品名稱</h3>
												<p class="menu-item-description" th:text="${prod.prodDesc}">商品描述</p>
												<span class="menu-item-price"
													th:text="'NT$ ' + ${prod.prodPrice}">價格</span>
											</div>

											<button class="favorite-btn favorite-product-btn"
												th:data-prodid="${prod.prodId}">
												<i
													th:classappend="${favoriteProdIds != null and favoriteProdIds.contains(prod.prodId)} ? 'fas fa-heart' : 'far fa-heart'"
													th:style="${favoriteProdIds != null and favoriteProdIds.contains(prod.prodId)} ? 'color:red' : ''"></i>
												收藏
											</button>
										</div>

									</div>

								</div>
								<!-- 店家資訊 Tab內容 -->
								<div class="tab-content"
									th:id="'info-content-' + ${store.storId}">
									<div class="info-section">
										<h3 class="info-title">店家位置</h3>
										<p>
											<strong th:text="${store.storName}">店家名稱</strong>
										</p>
										<p th:text="${store.storAddr}">店家地址</p>

										<div class="map-container" style="margin-top: 1em;">
											<!-- 有座標時顯示 Google 地圖 -->
											<iframe
												th:if="${store.storLat != null and store.storLon != null}"
												width="100%" height="300" frameborder="0" style="border: 0"
												allowfullscreen loading="lazy"
												referrerpolicy="no-referrer-when-downgrade"
												th:src="'https://www.google.com/maps?q=' + ${store.storLat} + ',' + ${store.storLon} + '&hl=zh-TW&z=16&output=embed'">
											</iframe>

											<!-- 沒有座標顯示預設圖 -->
											<img
												th:unless="${store.storLat != null and store.storLon != null}"
												src="/images/map-placeholder.svg" alt="預設地圖"
												style="width: 100%; height: 300px; object-fit: cover; border-radius: 8px;" />
										</div>
									</div>
								</div>
								<!-- ➕ 新增優惠券內容 (更動後版) -->
								<div class="tab-content"
									th:id="'coupon-content-' + ${store.storId}">
									<div class="menu-item"
										th:each="coupon : ${storeCouponMap[store.storId]}">

										<!-- 優惠券文字資訊 (這部分不變) -->
										<div class="menu-item-info">
											<h3 class="menu-item-name" th:text="${coupon.couType}">優惠券類型</h3>
											<p class="menu-item-description" th:text="${coupon.couDesc}">優惠券說明</p>
											<span class="menu-item-price"
												th:text="'最低消費：NT$ ' + ${coupon.couMinOrd}">最低消費金額</span>
										</div>

										<!-- 領取按鈕 (整合所有邏輯後的最終版本) -->
										<button type="button" class="favorite-btn"
											th:classappend="${claimedCouponIds != null and claimedCouponIds.contains(coupon.couId)} ? 'claimed' : 'favorite-coupon-btn'"
											th:data-couid="${coupon.couId}"
											th:disabled="${claimedCouponIds != null and claimedCouponIds.contains(coupon.couId)}">
											<!-- 4. 根據條件顯示不同圖示和文字 -->

											<!-- 情況 A: 已領取 -->
											<span
												th:if="${claimedCouponIds != null and claimedCouponIds.contains(coupon.couId)}">
												<i class="fas fa-check-circle"></i> 已領取
											</span>

											<!-- 情況 B: 未領取 -->
											<span
												th:unless="${claimedCouponIds != null and claimedCouponIds.contains(coupon.couId)}">
												<i class="far fa-heart"></i> 領取
											</span>
										</button>

									</div>
								</div>
								<!-- ==================== /優惠券項目區塊 ==================== -->

							</div>

						</div>

					</div>
				</article>
			</div>
		</div>
	</main>

	<footer th:replace="~{front/common/footer :: main-footer}"></footer>
	<!-- ==================== 商品燈箱 (Modal) 結構 ============================================================ -->
	<!-- ==================== 商品燈箱 (Modal) 結構 ============================================================ -->
	<div class="product-modal-overlay" id="productModalOverlay">
		<div class="product-modal-content">
			<button class="modal-close-btn" id="modalCloseBtn">&times;</button>
			<div class="modal-body">
				<div class="modal-product-image-container">
					<img id="modalProductImage" src="" alt="商品圖片"
						class="modal-product-image">
				</div>
				<div class="modal-product-info">
					<h2 id="modalProductName" class="modal-product-name">商品名稱</h2>
					<p id="modalProductDesc" class="modal-product-description">商品描述會顯示在這裡。</p>
					<div class="modal-price-and-controls">
						<span id="modalProductPrice" class="modal-product-price">NT$
							0</span>
						<div class="quantity-controls">
							<button class="quantity-btn" id="quantityDecrement">-</button>
							<input type="number" id="quantityInput" class="quantity-input"
								value="1" min="1" max="99" readonly>
							<button class="quantity-btn" id="quantityIncrement">+</button>
						</div>
					</div>
					<button id="addToCartBtn" class="btn btn-primary btn-add-to-cart">
						<span>加入購物車 - NT$ 0</span>
					</button>
				</div>
			</div>
		</div>
	</div>
	<!-- ==================== /商品燈箱 (Modal) 結構 ============================================================ -->
	<!-- ==================== /商品燈箱 (Modal) 結構 ============================================================ -->
	<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 收藏商品功能
        document.querySelectorAll('.favorite-product-btn').forEach(btn => {
            btn.addEventListener('click', function (e) {
                e.stopPropagation();
                const prodId = this.dataset.prodid;
                const icon = this.querySelector('i');
                const isFavorited = icon.classList.contains('fas');
                const url = isFavorited ? '/favorite/remove' : '/favorite/add';

                fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({prodId})
                })
                .then(async res => {
                    const contentType = res.headers.get('content-type') || "";

                 // 🔐 偵測未登入導向的 HTML 頁面
                 if (res.status === 401 || contentType.includes("text/html") || res.url.includes("/login")) {
                   showLoginPrompt();
                   throw new Error("未登入");
                 }

                 // 如果格式不是 JSON，就警告
                 if (!contentType.includes("application/json")) {
                   throw new Error("伺服器回傳格式錯誤");
                 }

                 // 錯誤情況下，解析 JSON 後丟錯
                 if (!res.ok) {
                   const err = await res.json();
                   throw new Error(err.error || "加入收藏失敗");
                 }


                    if (!contentType.includes("application/json")) {
                        throw new Error("伺服器回傳格式錯誤");
                    }

                    return res.json();
                })
                .then(data => {
                    icon.classList.toggle('fas', !isFavorited);
                    icon.classList.toggle('far', isFavorited);
                    icon.style.color = isFavorited ? '' : 'red';
                    showToast(isFavorited ? '已取消收藏' : '已加入收藏');
                })
                .catch(err => {
                    if (err.message !== "未登入") {
                        alert("錯誤：" + err.message);
                    }
                });


            });
        });

        //🔍 搜尋輸入框按 Enter 時跳轉搜尋
        document.querySelector('.search-input').addEventListener('keydown', function (e) {
            if (e.key === 'Enter') {
                const keyword = e.target.value.trim();
                if (keyword.length > 0) {
                    window.location.href = '/category?keyword=' + encodeURIComponent(keyword);
                }
            }
        });

        // Tab 切換功能
        document.querySelectorAll('.restaurant-detail').forEach(function (restaurantCard) {
            const tabBtns = restaurantCard.querySelectorAll('.tab-btn');

            tabBtns.forEach(function (btn) {
                btn.addEventListener('click', function () {
                    const storeId = this.dataset.storeid;
                    const tab = this.dataset.tab;

                    restaurantCard.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    restaurantCard.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

                    this.classList.add('active');

                    const contentId = `${tab}-content-${storeId}`;
                    const newContent = restaurantCard.querySelector(`#${contentId}`);
                    if (newContent) {
                        newContent.classList.add('active');
                    } else {
                        console.warn('找不到內容區塊:', contentId);
                    }
                });
            });
        });

        /**============================================================================== */
        /**============================================================================== */

        // 領取優惠券按鈕功能
        document.querySelectorAll('.favorite-coupon-btn').forEach(btn => {
    btn.addEventListener('click', function () {
        const couponId = this.dataset.couid;
        const button = this;

        fetch('/member/coupons/claim', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ couponId })
        })
            .then(async res => {
                const contentType = res.headers.get('content-type') || "";

                // 未登入導向登入頁的情況
                if (res.status === 401 || contentType.includes("text/html") || res.url.includes("/login")) {
                    showLoginPrompt();
                    throw new Error("未登入");
                }

                // 伺服器不是回傳 JSON
                if (!contentType.includes("application/json")) {
                    throw new Error("伺服器回傳格式錯誤");
                }

                // 狀態不是 OK，取錯誤訊息
                if (!res.ok) {
                    const err = await res.json();
                    throw new Error(err.message || "領取失敗");
                }

                return res.json();
            })
            .then(data => {
                if (data.success) {
                    alert('優惠券領取成功！');
                    button.disabled = true;
                    button.innerHTML = '<i class="fas fa-check-circle"></i> 已領取';
                    button.classList.add('claimed');
                } else {
                    alert(data.message || '領取失敗，請稍後再試。');
                }
            })
            .catch(error => {
                console.error('領取優惠券時發生錯誤:', error);
                if (error.message !== '未登入') {
                    alert('領取優惠券時發生錯誤，請檢查網路或稍後再試。');
                }
            });
    });
});


            // =================================================================
            // ==================== 商品燈箱 (Modal) 核心邏輯 ====================
            // =================================================================

            // 1. 獲取所有需要的 DOM 元素
        const modalOverlay = document.getElementById('productModalOverlay');
        const modalCloseBtn = document.getElementById('modalCloseBtn');
        const modalImage = document.getElementById('modalProductImage');
        const modalName = document.getElementById('modalProductName');
        const modalDesc = document.getElementById('modalProductDesc');
        const modalPrice = document.getElementById('modalProductPrice');
        const quantityInput = document.getElementById('quantityInput');
        const quantityDecrement = document.getElementById('quantityDecrement');
        const quantityIncrement = document.getElementById('quantityIncrement');
        const addToCartBtn = document.getElementById('addToCartBtn');

        let currentProductPrice = 0;
        let currentProdId = null;

        // 2. 使用事件委派，監聽整個餐廳列表的點擊事件，提高效能
        document.querySelector('.restaurant-list').addEventListener('click', function(e) {
            // 找到被點擊的、帶有 .product-clickable class 的父元素
            const productCard = e.target.closest('.product-clickable');

            if (productCard) {
                e.preventDefault(); // 防止可能的默認行為
                openProductModal(productCard);
            }
        });


        /**
         * 開啟並填充商品燈箱
         * @param {HTMLElement} productCard - 被點擊的商品卡片元素
         */
        function openProductModal(productCard) {

            const productData = productCard.dataset;
            currentProdId = parseInt(productData.prodId, 10);
            currentProductPrice = parseFloat(productData.prodPrice);

            modalImage.src = `/product/image/${productData.prodId}`;
            modalImage.alt = productData.prodName;
         // 加上 fallback：若圖片失敗就改顯示預設圖
            modalImage.onerror = () => {
                modalImage.src = '/images/restaurant/placeholder.svg';
            };
            modalName.textContent = productData.prodName;
            modalDesc.textContent = productData.prodDesc;
            modalPrice.textContent = `NT$ ${currentProductPrice}`;

            quantityInput.value = 1;
            updateAddToCartButton();

            // 顯示燈箱
            modalOverlay.classList.add('active');
        }

        /**
         * 關閉商品燈箱
         */
        function closeProductModal() {
            modalOverlay.classList.remove('active');
        }

        /**
         * 更新「加入購物車」按鈕上的文字和總價
         */
        function updateAddToCartButton() {
            const quantity = parseInt(quantityInput.value, 10);
            const totalPrice = currentProductPrice * quantity;
            addToCartBtn.querySelector('span').textContent = `加入購物車 - NT$ ${totalPrice}`;
        }

        // 3. 綁定燈箱內的事件監聽器
        // 關閉按鈕
        modalCloseBtn.addEventListener('click', closeProductModal);
        // 點擊背景遮罩關閉
        modalOverlay.addEventListener('click', function(e) {
            if (e.target === modalOverlay) {
                closeProductModal();
            }
        });

        // 數量增加
        quantityIncrement.addEventListener('click', () => {
            let currentVal = parseInt(quantityInput.value, 10);
            if (currentVal < 99) {
                quantityInput.value = currentVal + 1;
                updateAddToCartButton();
            }
        });

        // 數量減少
        quantityDecrement.addEventListener('click', () => {
            let currentVal = parseInt(quantityInput.value, 10);
            if (currentVal > 1) {
                quantityInput.value = currentVal - 1;
                updateAddToCartButton();
            }
        });

        // 「加入購物車」按鈕點擊事件
        addToCartBtn.addEventListener('click', function() {
            const quantity = parseInt(quantityInput.value, 10);

            // 準備要發送到後端的資料
            const formData = new URLSearchParams();
            formData.append('prodId', currentProdId);
            formData.append('quantity', quantity);

            // 發送異步請求
            fetch('/cart/api/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    // 如果有 CSRF token，也需要加在這裡
                },
                body: formData
            })
                .then(response => {
                    if (response.status === 401) {
                        // 處理未登入的情況
                        showLoginPrompt(); // 調用您現有的登入提示框
                        return Promise.reject('User not logged in'); // 中斷 then 鏈
                    }
                    if (!response.ok) {
                        // 處理其他伺服器錯誤
                        return response.json().then(err => Promise.reject(err.message || '伺服器錯誤'));
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success) {
                        closeProductModal();
                        showToast(data.message); // 調用您現有的提示訊息框
                        // (可選) 更新頁首購物車圖標的數字
                        // const cartCountElement = document.querySelector('.cart-count');
                        // if (cartCountElement && data.cartItemCount !== undefined) {
                        //     cartCountElement.textContent = data.cartItemCount;
                        // }
                    } else {
                        alert('錯誤：' + data.message);
                    }
                })
                .catch(error => {
                    if (error !== 'User not logged in') {
                        console.error('加入購物車失敗:', error);
                        alert('加入購物車時發生未知錯誤，請查看控制台。');
                    }
                });
        });

    });

    function showLoginPrompt() {
        document.getElementById('login-prompt-modal').style.display = 'flex';
    }

    function closeLoginPrompt() {
        document.getElementById('login-prompt-modal').style.display = 'none';
    }

    function showToast(message) {
        const toast = document.getElementById('toast-message');
        toast.textContent = message;
        toast.style.display = 'block';
        setTimeout(() => {
            toast.style.display = 'none';
        }, 2000);
    }


</script>
	<div id="login-prompt-modal"
		style="display: none; position: fixed; z-index: 9999; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.5); align-items: center; justify-content: center;">
		<div
			style="background: #fff; padding: 2em; border-radius: 10px; text-align: center; max-width: 300px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);">
			<h3>⚠️ 請先登入會員</h3>
			<p style="margin: 1em 0;">您必須登入會員才能加入收藏清單。</p>
			<div style="margin-top: 1em;">
				<button onclick="location.href='/front/member/login'">立即登入</button>
				<button onclick="closeLoginPrompt()">取消</button>
			</div>
		</div>
	</div>
	<div id="toast-message"
		style="position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); background-color: #444; color: #fff; padding: 10px 20px; border-radius: 8px; display: none; font-size: 16px; z-index: 9999;">
	</div>
</body>
</html>